<html>
 <head>
   <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/pure-min.css" />
   <link rel="stylesheet" href="style.css" />
   <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
   <script src="mustache.js"></script>
   <script src="FileSaver.min.js"></script>
  
   <meta name="viewport" content="width=device-width, initial-scale=1" />
 </head>
<body>
  <div class="selection_section">
    <a class="pure-button pure-button-active" href="#" id="select_section_1">Section #1</a>
    <a class="pure-button pure-button-active" href="#" id="select_section_2">Section #2</a>
    <a class="pure-button pure-button-active" href="#" id="select_section_3">Section #3</a>
    <a class="pure-button pure-button-active" href="#" id="select_section_4">Section #4</a>
  </div>
 <div id='core' />
 </body>
 <script>


/* Rendering functions */
function render_sections()
{
  var view = {
    sections: []
  };
  for(var iSection=1; iSection<=4; iSection++) {
    var section = {
      categories: [],
      sectionIdx: iSection
    };
    for(var iCategory=1; iCategory<=6; iCategory++)
    {
      var category = {
        details: [],
        categoryIdx: iCategory
      };
      for(var iDetail=1; iDetail<=6; iDetail++)
      {
        category.details.push(iDetail);
      }
      section.categories.push(category);
    }
    
    view.sections.push(section);
  }
  
  return Mustache.render("{{#sections}}<div class='section' id='section{{sectionIdx}}'>" +
                             "<div class='sectionTitle'>" +
                                 "<input id='section{{sectionIdx}}' type='text' class='sectionTextInput' />" +
                             "</div>" +
                             "{{#categories}}<div class='category'>" +
                                 "<div class='categoryTitle'>" + 
                                     "<img src='dice{{categoryIdx}}.png' class='categoryDice' />" +
                                     "<input id='sec{{sectionIdx}}_cat{{categoryIdx}}' type='text' class='categoryTextInput' />" +
                                     "<div class='category_showhide'> - </div>" +
                                 "</div>" +
                                 "{{#details}}<div class='categoryDetail'>" +
                                     "<img src='dice{{.}}.png' class='categoryDetailDice' />" + 
                                     "<input id='sec{{sectionIdx}}_cat{{categoryIdx}}_detail{{.}}' type='text' class='categoryDetailTextInput' />" +
                                 "</div>{{/details}}" +
                             "</div>{{/categories}}" +
                         "</div>{{/sections}}"
                         , view);
}

function click_section(sectionIdx)
{
  for(var iSection=1; iSection<=4; iSection++)
  {
    var sectionName = '#section' + iSection;
    if (iSection == sectionIdx)
    {
      // Showing the section
      $(sectionName).show();
    }
    else 
    {
      // Hiding the section
      $(sectionName).hide();
    }
  }
}

$(function() {
  $("#core").html(render_sections());
  
  for (var iSection = 1; iSection<=4; iSection++) {
        var selector = "#select_section_" + iSection;
        $(selector).on('click', {id: iSection}, function (e) {
            click_section(e.data.id);
        });
    }
  click_section(1);
  $('.category_showhide').click(function() {
    $(this).parent().siblings('.categoryDetail').hide();
  });
  
});
  </script>
</html>

